# DESKRIPSI

If you can find the flag on this disk image, we can close the case for good!
Download the disk image here.

# SOLUSI

Pertama kita download filenya, setelah mendownload file kita cek termasuk apa format/ ekstensi file tersebut

```file disk.flag.img.gz``` ___gz___ membuktikan bahwa file di zip menggunakan gunzip, maka kita tinggal melakukan perintah ```gunzip disk.flag.img.gz``` dan mendapatkan file ___disk.flag.img___

Kita cari tau lagi file termasuk apa ```file disk.flag.immg``` 
```
disk.flag.img: DOS/MBR boot sector; partition 1 : ID=0x83, active, start-CHS (0x0,32,33), end-CHS (0x26,94,56), startsector 2048, 614400 sectors; partition 2 : ID=0x82, start-CHS (0x26,94,57), end-CHS (0x47,1,58), startsector 616448, 524288 sectors; partition 3 : ID=0x83, start-CHS (0x47,1,59), end-CHS (0x82,138,8), startsector 1140736, 956416 sectors
```
File merupakan disk, kita coba jalankan perintah ```mmls disk.flag.img``` 
```
DOS Partition Table
Offset Sector: 0
Units are in 512-byte sectors

      Slot      Start        End          Length       Description
000:  Meta      0000000000   0000000000   0000000001   Primary Table (#0)
001:  -------   0000000000   0000002047   0000002048   Unallocated
002:  000:000   0000002048   0000616447   0000614400   Linux (0x83)
003:  000:001   0000616448   0001140735   0000524288   Linux Swap / Solaris x86 (0x82)
004:  000:002   0001140736   0002097151   0000956416   Linux (0x83)
```
Kita dapat mengetahui bahwa offset dari partsi 1 mulai dari ___2048___ dan partisi 3 mulai dari ___1140736___

Selanjutnya kita coba cari tau list dari partisi 1 : ```fls -o 2048 disk.flag.img```

fls : untuk melihat list file pada sistem 
-o <offset> : untuk tujuan offset yang kita cek fls
disk.flag.img : file disk

dan pada saat menjalankan perintah ```fls -o 2048 disk.flag.img```
Kita tidak mennemukan sebuah petunjuk jadi kita coba pada partisi 3
```fls -o 1140736 disk.flag.img```

Output memberikan petunjuk pada dir root ___d/d 204:	root___
Jadi kita coba saja buka file root ```fls -o 1140736 disk.flag.img 204```

204 : kode pada dir root
```
r/r 1837:	.ash_history
d/d 1842:	secret-secrets
```
Output menunjukkan ada secret jadi kita coba buka ```fls -o 1140736 disk.flag.img 1842```
```
r/r 1843:	force-wait.sh
r/r 1844:	innocuous-file.txt
r/r 1845:	its-all-in-the-name
```
Terdapat file ekstensi file kita coba baca ```icat -o 1140736 disk.flag.img 8 | strings```

icat : membaca file/disk,
-o <offset> : tujuan dari icat,
8 : sector,
| strings : menggabungkan strings pada command 

Saya menggunakan icat untuk membaca offset 1140736 dari 8 sector partisi 3 dan kita akan coba menggunakan xxd untuk mengkonversi output menjadi hexadesimal dan menggunakan grep untuk mencari flag

```icat -o 1140736 disk.flag.img 8 | xxd | grep "file"```

```
00019030: 7072 6f66 696c 6500 0000 0000 0000 0000  profile.........
00019220: 1400 0902 7072 6f66 696c 652e 6400 0000  ....profile.d...
00071410: 7570 2e66 696c 6573 f8fd 0000 1c00 1201  up.files........
00071480: 6170 2e66 696c 6573 06fe 0000 1400 0b01  ap.files........
00071540: 7866 732e 6669 6c65 7300 0000 21fe 0000  xfs.files...!...
00071800: 0afe 0000 1400 0901 6e62 642e 6669 6c65  ........nbd.file
00072c20: 2e66 696c 6573 0000 16fe 0000 1800 1001  .files..........
00072c60: 6775 6172 642e 6669 6c65 7300 20fe 0000  guard.files. ...
00072c70: d402 0901 7a66 732e 6669 6c65 7300 0000  ....zfs.files...
00072f60: 2e66 696c 6573 0000 0000 0000 0000 0000  .files..........
00074450: 6669 6c65 7300 0000 11fe 0000 1400 0c01  files...........
000744d0: 2e66 696c 6573 0000 f9fd 0000 a800 1001  .files..........
000745a0: 6669 6c65 7300 0000 0000 0000 0000 0000  files...........
00074660: 6368 6172 742e 6669 6c65 7300 f3fd 0000  chart.files.....
00074690: 2e66 696c 6573 0000 fbfd 0000 1400 0c01  .files..........
000bb090: 6566 696c 6573 0000 c803 0000 0c00 0402  efiles..........
000bc860: 6361 6368 6566 696c 6573 2e6b 6f2e 677a  cachefiles.ko.gz
000c4c30: 1400 0a02 6669 6c65 6c61 796f 7574 0000  ....filelayout..
000c4c40: f903 0000 1800 0e02 666c 6578 6669 6c65  ........flexfile
000c5870: 315f 6669 6c65 732e 6b6f 2e67 7a00 0000  1_files.ko.gz...
0019d030: 7072 6f66 696c 6500 0000 0000 0000 0000  profile.........
0019d220: 1400 0902 7072 6f66 696c 652e 6400 0000  ....profile.d...
001f8840: 732d 6669 6c65 2e74 7874 0000 0000 0000  s-file.txt......
001fbc40: 732d 6669 6c65 2e74 7874 0000 3507 0000  s-file.txt..5...
001fdc40: 732d 6669 6c65 2e74 7874 0000 0000 0000  s-file.txt......
001ff440: 732d 6669 6c65 2e74 7874 0000 3507 0000  s-file.txt..5...
00201840: 732d 6669 6c65 2e74 7874 0000 0000 0000  s-file.txt......
00203c40: 732d 6669 6c65 2e74 7874 0000 3507 0000  s-file.txt..5...
00206040: 732d 6669 6c65 2e74 7874 0000 0000 0000  s-file.txt......
00207840: 732d 6669 6c65 2e74 7874 0000 3507 0000  s-file.txt..5...
00209c40: 732d 6669 6c65 2e74 7874 0000 0000 0000  s-file.txt......
0020b440: 732d 6669 6c65 2e74 7874 0000 3507 0000  s-file.txt..5...
0020d840: 732d 6669 6c65 2e74 7874 0000 0000 0000  s-file.txt......
0020fc40: 732d 6669 6c65 2e74 7874 0000 3507 0000  s-file.txt..5...
00211440: 732d 6669 6c65 2e74 7874 0000 0000 0000  s-file.txt......
```
Mendapatkan output seperti yang diatas, coba kita mencari ekstensi ___.txt___
```icat -o 1140736 disk.flag.img 8 | xxd | grep ".txt" -A3```

___icat___ membaca dari offset ___1140736___ dari file ___disk.flag.img___ dan di konversi jadi hexa oleh ___xxd___ dan dicari file bernama .txt oleh ___grep___ dan berjumlah 3 baris kebawah dari ___-A3___
```
001f8840: 732d 6669 6c65 2e74 7874 0000 0000 0000  s-file.txt......
001f8850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
001f8860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
001f8870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
--
001fbc40: 732d 6669 6c65 2e74 7874 0000 3507 0000  s-file.txt..5...
001fbc50: a803 1101 6f72 6967 696e 616c 2d66 696c  ....original-fil
001fbc60: 656e 616d 6500 0000 0000 0000 0000 0000  ename...........
001fbc70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
--
001fdc40: 732d 6669 6c65 2e74 7874 0000 0000 0000  s-file.txt......
001fdc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
001fdc60: 0000 0000 0000 0000 3507 0000 8c03 0301  ........5.......
001fdc70: 7069 6300 0000 0000 0000 0000 0000 0000  pic.............
--
001ff440: 732d 6669 6c65 2e74 7874 0000 3507 0000  s-file.txt..5...
001ff450: a803 0301 6f43 5400 0000 0000 0000 0000  ....oCT.........
001ff460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
001ff470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
--
00201840: 732d 6669 6c65 2e74 7874 0000 0000 0000  s-file.txt......
00201850: 0000 0000 0000 0000 3507 0000 9c03 0301  ........5.......
00201860: 467b 3100 0000 0000 0000 0000 0000 0000  F{1.............
00201870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
--
00203c40: 732d 6669 6c65 2e74 7874 0000 3507 0000  s-file.txt..5...
00203c50: a803 0301 5f35 3300 0000 0000 0000 0000  ...._53.........
00203c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00203c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
--
00206040: 732d 6669 6c65 2e74 7874 0000 0000 0000  s-file.txt......
00206050: 0000 0000 0000 0000 3507 0000 9c03 0301  ........5.......
00206060: 335f 6e00 0000 0000 0000 0000 0000 0000  3_n.............
00206070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
--
00207840: 732d 6669 6c65 2e74 7874 0000 3507 0000  s-file.txt..5...
00207850: a803 0301 346d 3300 0000 0000 0000 0000  ....4m3.........
00207860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00207870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
--
00209c40: 732d 6669 6c65 2e74 7874 0000 0000 0000  s-file.txt......
00209c50: 0000 0000 0000 0000 3507 0000 9c03 0301  ........5.......
00209c60: 355f 3800 0000 0000 0000 0000 0000 0000  5_8.............
00209c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
--
0020b440: 732d 6669 6c65 2e74 7874 0000 3507 0000  s-file.txt..5...
0020b450: a803 0301 3064 3200 0000 0000 0000 0000  ....0d2.........
0020b460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
0020b470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
--
0020d840: 732d 6669 6c65 2e74 7874 0000 0000 0000  s-file.txt......
0020d850: 0000 0000 0000 0000 3507 0000 9c03 0301  ........5.......
0020d860: 3462 3300 0000 0000 0000 0000 0000 0000  4b3.............
0020d870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
--
0020fc40: 732d 6669 6c65 2e74 7874 0000 3507 0000  s-file.txt..5...
0020fc50: a803 0201 307d 0000 0000 0000 0000 0000  ....0}..........
0020fc60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
0020fc70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
--
00211440: 732d 6669 6c65 2e74 7874 0000 0000 0000  s-file.txt......
00211450: 0000 0000 0000 0000 3507 0000 9c03 1301  ........5.......
00211460: 6974 732d 616c 6c2d 696e 2d74 6865 2d6e  its-all-in-the-n
00211470: 616d 6500 0000 0000 0000 0000 0000 0000  ame.............
```
Mendapatkan flag dan dapat di rangkai menjadi 1 : picoCTF{1_533_n4m35_...}
